<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìƒ í˜ì´ì§€ - ì—­í•  í™•ì¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* ì»¤ìŠ¤í…€ CSS Grid ì‹œìŠ¤í…œ */
        .main-container {
            height: 100vh;
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 1rem;
            padding: 1rem 3rem;
            box-sizing: border-box;
        }
        
        .header-area {
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem;
            color: white;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 36vh 36vh;
            gap: 0.8rem;
            height: 100%;
            max-height: calc(100vh - 140px);
            margin-bottom: 1rem;
        }
        
        .grid-item {
            border-radius: 1rem;
            padding: 0.8rem;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            min-height: 0; /* flex ì•„ì´í…œì´ ì¶•ì†Œë  ìˆ˜ ìˆë„ë¡ */
            max-height: 36vh; /* ê·¸ë¦¬ë“œ í–‰ ë†’ì´ì™€ ì¼ì¹˜ */
        }
        
        /* ì‹¤ì œ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .student-info, .daily-points, 
        .daily-tasks, .notice-board, .teacher-message {
            background-color: white;
        }
        
        /* === ê°œì„ ëœ í”Œë¦½ ì¹´ë“œ ë””ìì¸ === */
        /* í”Œë¦½ ì¹´ë“œ ì»¨í…Œì´ë„ˆ - ì„ ìƒë‹˜ìª½ì§€í•¨ê³¼ ì™„ì „ ë™ì¼í•œ í¬ê¸° */
        .flip-card {
            width: 100%;
            height: 100%;
            max-height: 100%;
            margin: 0;
            padding: 0;
            perspective: 1000px;
            cursor: pointer;
            box-sizing: border-box;
        }
        
        /* ì¹´ë“œ ë‚´ë¶€ ì»¨í…Œì´ë„ˆ (3D ë³€í™˜ìš©) */
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            max-height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
            box-sizing: border-box;
        }
        
        /* í”Œë¦½ ìƒíƒœ */
        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }
        
        /* ì¹´ë“œ ì•ë©´ê³¼ ë’·ë©´ì˜ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 1rem;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        /* ì¹´ë“œ ì•ë©´ */
        .card-front {
            background: linear-gradient(135deg, #9333ea 0%, #3b82f6 100%);
            color: white;
            justify-content: center;
            align-items: center;
        }
        
        /* ì¹´ë“œ ë’·ë©´ */
        .card-back {
            background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%);
            color: white;
            transform: rotateY(180deg);
            padding: 1rem;
            position: relative;
        }

        /* ë’·ë©´ ì»¨í…ì¸  ì˜ì—­ - ì „ì²´ ì‚¬ìš© */
        .card-back-content {
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.8rem;
            padding: 2rem;
            overflow-y: auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* í™œë™ ì•ˆë‚´ í…ìŠ¤íŠ¸ */
        #detailMissions {
            color: #fef08a;
            font-size: 1.25rem;
            line-height: 1.8;
            font-weight: 600;
            white-space: pre-wrap;
            text-align: center;
            width: 100%;
        }
        
        /* í˜¸ë²„ íš¨ê³¼ */
        .flip-card:hover .flip-card-inner {
            transform: scale(1.05);
        }
        
        .flip-card.flipped:hover .flip-card-inner {
            transform: rotateY(180deg) scale(1.05);
        }
        
        /* === ë©”ì‹œì§€ í”Œë¦½ ì¹´ë“œ ìŠ¤íƒ€ì¼ === */
        .message-flip-card {
            width: 100%;
            height: calc(100% - 3rem);
            position: relative;
            perspective: 1000px;
        }
        
        .message-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .message-flip-card.flipped .message-flip-inner {
            transform: rotateY(180deg);
        }
        
        .message-card-front, .message-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .message-card-front {
            background: white;
        }
        
        .message-card-back {
            background: linear-gradient(135deg, #f8a5a5 0%, #f8a5a5 100%);
            transform: rotateY(180deg);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* ë©”ì‹œì§€ ì¹´ë“œ ë²„íŠ¼ ê°•ì¡° ìŠ¤íƒ€ì¼ */
        .message-card-back button {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            font-weight: 600;
        }
        
        .message-card-back button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        /* í•™ìŠµì•ˆë‚´ í”Œë¦½ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .learning-guide-flip-card {
            cursor: pointer;
            perspective: 1000px;
            transition: transform 0.3s ease;
        }
        
        .learning-guide-flip-card:hover {
            transform: scale(1.02);
        }
        
        .learning-guide-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }
        
        .learning-guide-flip-card.flipped .learning-guide-flip-inner {
            transform: rotateY(180deg);
        }
        
        .learning-guide-front, .learning-guide-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 1rem;
            padding: 0.8rem;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .learning-guide-front {
            background: linear-gradient(145deg, #ffffff 0%, #f8faff 100%);
            border: 2px solid rgba(255, 255, 255, 0.8);
        }
        
        .learning-guide-back {
            background: linear-gradient(135deg, #7c8fe8 0%, #8b7ab8 100%);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transform: rotateY(180deg);
        }
        
        /* ë§í¬ ìŠ¤íƒ€ì¼ */
        .guide-link {
            color: #c7d2fe;
            text-decoration: underline;
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .guide-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: #fbbf24;
            text-decoration: none;
        }
        
        /* í•™ìŠµì•ˆë‚´ ë‚´ìš© ìŠ¤íƒ€ì¼ */
        .learning-guide-content {
            line-height: 1.6;
            text-align: left;
        }
        
        .learning-guide-content p {
            margin-bottom: 0.75rem;
        }
        
        .learning-guide-content p:last-child {
            margin-bottom: 0;
        }
        
        /* === ì˜¤ëŠ˜ì˜í• ì¼ í”Œë¦½ì¹´ë“œ ìŠ¤íƒ€ì¼ === */
        .daily-tasks-flip-card {
            width: 100%;
            height: 100%;
            position: relative;
            perspective: 1000px;
            cursor: pointer;
        }
        
        .daily-tasks-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }
        
        .daily-tasks-flip-card.flipped .daily-tasks-flip-inner {
            transform: rotateY(180deg);
        }
        
        .daily-tasks-front, .daily-tasks-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            border-radius: 1rem;
            overflow: hidden;
        }
        
        .daily-tasks-front {
            background: linear-gradient(145deg, #ffffff 0%, #f8faff 100%);
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .daily-tasks-back {
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 50%, #c084fc 100%);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transform: rotateY(180deg);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }
        
        /* í”Œë¦½ íŒíŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
        .daily-tasks-flip-card:hover .daily-tasks-front {
            transform: scale(1.02);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        .daily-tasks-flip-card.flipped:hover .daily-tasks-back {
            transform: rotateY(180deg) scale(1.02);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
        }

        /* ê³µì§€ì‚¬í•­, ì„ ìƒë‹˜ë§ì”€ í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì • */
        .notice-text {
            font-size: 0.9em !important;
            line-height: 1.4 !important;
            text-align: justify !important;
            text-justify: inter-word !important;
        }
        
        /* ì „ì²´ì ì¸ ì‹œê° ê°œì„  */
        .grid-item {
            background: linear-gradient(145deg, #ffffff 0%, #f8faff 100%);
            border: 2px solid rgba(255, 255, 255, 0.8);
        }
        
        /* ì—­í•  ë°°ì • ì„¹ì…˜ ë°°ê²½ ì„¤ì • - ì„ ìƒë‹˜ìª½ì§€í•¨ê³¼ ë™ì¼í•œ í¬ê¸° */
        .grid-item.role-assignment {
            background: linear-gradient(145deg, #ffffff 0%, #f8faff 100%);
            padding: 0.8rem; /* ë‹¤ë¥¸ ì¹´ë“œì™€ ì™„ì „ ë™ì¼í•œ íŒ¨ë”© */
            box-sizing: border-box;
        }
        
        .grid-item h3 {
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* border-3 í´ë˜ìŠ¤ ì¶”ê°€ */
        .border-3 {
            border-width: 3px;
        }
        
        /* ìª½ì§€í•¨ ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .message-list-container {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            padding: 0.25rem;
            height: 100%;
            overflow-y: auto;
        }
        
        .message-list-item {
            background: white;
            border-radius: 0.5rem;
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .message-list-item:hover {
            background: #f9fafb;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }
        
        .message-list-item.first-item {
            border-left: 3px solid #ef4444;
        }
        
        .message-item-content {
            flex: 1;
            min-width: 0;
            padding: 0 0.25rem;
        }
        
        .message-text {
            font-size: 0.85rem;
            line-height: 1.3;
            color: #374151;
            margin-bottom: 0.25rem;
            word-break: break-word;
        }
        
        .message-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.7rem;
            color: #6b7280;
        }
        
        .message-date {
            white-space: nowrap;
        }
        
        .new-badge {
            background: #ef4444;
            color: white;
            padding: 0.1rem 0.3rem;
            border-radius: 0.25rem;
            font-size: 0.6rem;
            font-weight: bold;
        }
        
        .reply-indicator {
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px dashed #e5e7eb;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #6b7280;
            font-size: 0.75rem;
        }
        
        .reply-prefix {
            font-weight: 500;
            color: #9ca3af;
        }

        
        /* ê³µì§€ì‚¬í•­ ì¹´ë“œ ìŠ¤íƒ€ì¼ - ì„ ìƒë‹˜ë§ì”€ê³¼ ë¹„ìŠ·í•œ í†¤ */
        .notice-card {
            background: linear-gradient(135deg, #faf8fc 0%, #f3e5f5 100%);
            border-radius: 0.5rem;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #ba68c8;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .notice-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .notice-title {
            font-size: 0.9rem;
            font-weight: bold;
            color: #000000;
            margin-bottom: 0.3rem;
        }
        
        .notice-content {
            font-size: 0.8rem;
            color: #000000;
            line-height: 1.6;
        }
        
        .notice-date {
            font-size: 0.6rem;
            color: #666666;
            margin-top: 0.4rem;
            text-align: right;
        }
        
        /* ì´ë¯¸ì§€ ì—­í•  - ë°°ì¹˜ ê°œì„  */
        #imageRoleDisplay {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0;
            gap: 0;
            position: relative; /* ì œëª© ìœ„ì¹˜ ì¡°ì •ì„ ìœ„í•œ relative */
        }
        
        #roleImage {
            max-height: 75px !important; /* ì´ë¯¸ì§€ í¬ê¸° 50% ì¶•ì†Œ (150px â†’ 75px) */
            max-width: 85%;
            width: auto;
            height: auto;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        #imageRoleName {
            font-size: 1.25rem; /* í°íŠ¸ í¬ê¸° 50% ì¶•ì†Œ (1.75rem â†’ 1.25rem) */
            font-weight: bold;
            color: white;
            text-shadow: 0 1px 4px rgba(0,0,0,0.4);
            margin: 0;
            padding: 0;
            text-align: center;
            position: absolute;
            bottom: 0.5rem; /* ë°°ìƒ‰ì¹´ë“œ ëì—ì„œ 0.5rem ìœ„ë¡œ ì¡°ì • */
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(6, minmax(300px, auto));
                gap: 1.5rem;
            }
            .grid-item {
                padding: 2rem;
            }
            .main-container {
                padding: 1rem;
                gap: 1rem;
            }
            .header-area {
                height: 100px;
                padding: 0 2rem;
            }
        }
        
        /* 13ì¸ì¹˜ í¬ë¡¬ë¶ íŠ¹ë³„ ìµœì í™” (1366x768) */
        @media (max-width: 1366px) and (max-height: 768px) {
            #roleImage {
                max-height: 60px !important; /* 13ì¸ì¹˜ì—ì„œ ì´ë¯¸ì§€ í¬ê¸° 50% ì¶•ì†Œ (120px â†’ 60px) */
                max-width: 80%;
            }
            
            #imageRoleName {
                font-size: 1.0rem; /* í°íŠ¸ í¬ê¸° 50% ì¶•ì†Œ (1.5rem â†’ 1.0rem) */
                bottom: 0.25rem; /* 13ì¸ì¹˜ì—ì„œ 0.25remë¡œ ì¡°ì • */
            }
            
            /* role-assignment íŠ¹ë³„ min-height ì œê±° - ëª¨ë“  ì¹´ë“œ ë™ì¼í•œ í¬ê¸° */
            
            #imageRoleDisplay {
                padding: 0; /* 13ì¸ì¹˜ì—ì„œë„ ì—¬ë°± ì œê±° */
                gap: 0; /* gapë„ ì œê±° */
            }
        }
        
        /* ë” ì‘ì€ í™”ë©´ (11ì¸ì¹˜ ì´í•˜) */
        @media (max-width: 1200px) and (max-height: 700px) {
            #roleImage {
                max-height: 55px !important; /* ì‘ì€ í™”ë©´ì—ì„œ ì´ë¯¸ì§€ í¬ê¸° 50% ì¶•ì†Œ (110px â†’ 55px) */
                max-width: 75%;
            }
            
            #imageRoleName {
                font-size: 0.95rem; /* í°íŠ¸ í¬ê¸° 50% ì¶•ì†Œ (1.25rem â†’ 0.95rem) */
                bottom: 0.3rem; /* ì‘ì€ í™”ë©´ì—ì„œ 0.3remë¡œ ì¡°ì • */
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-50 m-0 p-0">
    
    <!-- ë¡œê·¸ì¸ ì„¹ì…˜ -->
    <div id="loginSection" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full">
            <div class="text-center mb-6">
                <div class="mb-4">
                    <i class="fas fa-sushi text-4xl text-purple-500 mb-2"></i>
                    <h1 class="text-2xl font-bold text-gray-800">ì°½ê±´ìƒ˜ì˜ ê¹€ë°¥êµì‹¤</h1>
                </div>
                <i class="fas fa-sign-in-alt text-3xl text-purple-500 mb-3"></i>
                <h2 class="text-xl font-bold text-gray-800">ê°„í¸ ë¡œê·¸ì¸</h2>
                <p class="text-gray-600 mt-2">í•™ë²ˆê³¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”</p>
            </div>

            <form onsubmit="studentLogin(event)">
                <!-- ì—ëŸ¬ ë©”ì‹œì§€ ì˜ì—­ -->
                <div id="loginErrorMessage" class="hidden mb-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
                        <span id="loginErrorText" class="text-red-700 text-sm"></span>
                    </div>
                </div>
                
                <!-- ì„±ê³µ ë©”ì‹œì§€ ì˜ì—­ -->
                <div id="loginSuccessMessage" class="hidden mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-green-700 text-sm">ë¡œê·¸ì¸ ì„±ê³µ! ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</span>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-id-card mr-1 text-purple-500"></i>í•™ë²ˆ
                    </label>
                    <input type="text" id="loginStudentId" 
                           placeholder="ì˜ˆ: 4103" 
                           pattern="[0-9]{4}"
                           maxlength="4"
                           required
                           autocomplete="off"
                           class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg transition-colors">
                    <p class="text-xs text-gray-500 mt-1">4ìë¦¬ ìˆ«ì (í•™ë…„/ë°˜/ë²ˆí˜¸)</p>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-user mr-1 text-purple-500"></i>ì´ë¦„
                    </label>
                    <input type="text" id="loginStudentName" 
                           placeholder="ì˜ˆ: í™ê¸¸ë™" 
                           required
                           autocomplete="off"
                           class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg transition-colors">
                </div>

                <button type="submit" id="loginButton"
                        class="w-full bg-gradient-to-r from-purple-500 to-purple-600 text-white font-bold py-3 rounded-lg hover:opacity-90 transition transform hover:scale-105 disabled:opacity-50 disabled:transform-none disabled:cursor-not-allowed">
                    <span id="loginButtonText">
                        <i class="fas fa-arrow-right mr-2"></i>ë¡œê·¸ì¸
                    </span>
                    <span id="loginLoadingText" class="hidden">
                        <i class="fas fa-spinner fa-spin mr-2"></i>ë¡œê·¸ì¸ ì¤‘...
                    </span>
                </button>
            </form>
        </div>
    </div>

    <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ (ë¡œê·¸ì¸ í›„) -->
    <div id="roleSection" class="main-container hidden">
        
        <!-- í—¤ë” ì˜ì—­ -->
        <div class="header-area">
            <div class="flex items-center space-x-3">
                <i class="fas fa-sushi text-2xl"></i>
                <h1 class="font-bold" style="font-size: 3rem;">ì°¸ì¹˜ê¹€ë°¥</h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">

                    <p class="font-bold" style="font-size: 2rem;">
                        <span id="displayStudentId" class="text-yellow-300"></span> 
                        <span id="displayStudentName" class="ml-2"></span>
                    </p>
                </div>
                <div class="flex items-center space-x-2">
                    <a href="index.html" class="text-white hover:text-yellow-300 transition">
                        <i class="fas fa-home text-xl"></i>
                    </a>
                    <button onclick="logout()" class="text-white hover:text-yellow-300 transition">
                        <i class="fas fa-sign-out-alt text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 6ì˜ì—­ ê·¸ë¦¬ë“œ -->
        <div class="content-grid">
            
            <!-- 1. í•™ìƒì •ë³´ (ì¢Œìƒ) -->
            <div class="grid-item student-info">
                <h3 class="font-bold mb-2 text-center" style="font-size: 1.4rem;">ğŸ‘¤ í•™ìƒ ì •ë³´</h3>
                <div class="text-center flex-1 flex flex-col justify-center">
                    <div class="bg-purple-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user text-purple-600 text-2xl"></i>
                    </div>
                    <p class="text-gray-500 mb-1" style="font-size: 0.8rem;">í˜„ì¬ ë¡œê·¸ì¸</p>
                    <p class="font-bold text-gray-800 leading-tight" style="font-size: 1rem;">
                        <span id="displayStudentId2" class="text-purple-600"></span> 
                        <span id="displayStudentName2" class="ml-2"></span>
                    </p>
                </div>
            </div>

            <!-- 2. ì˜¤ëŠ˜ì˜ í¬ì¸íŠ¸ (ì¤‘ìƒ) -->
            <div id="pointDisplaySection" class="grid-item daily-points">
                <h3 class="font-bold mb-2 text-center" style="font-size: 1.4rem;">ğŸª™ ì˜¤ëŠ˜ì˜ í¬ì¸íŠ¸</h3>
                <p class="text-gray-500 mb-1 text-center" id="todayDate" style="font-size: 0.7rem;"></p>
                <div class="text-center flex-1 flex flex-col justify-center">
                    <div class="flex items-center justify-center mb-4">
                        <i class="fas fa-coins text-yellow-500 text-3xl mr-3"></i>
                        <div class="font-bold text-yellow-600" id="totalPoints" style="font-size: 1.5rem;">0</div>
                    </div>
                    <div class="text-gray-500 mb-1" style="font-size: 0.7rem;">í˜„ì¬ í¬ì¸íŠ¸</div>
                    <div class="bg-gray-200 rounded-full h-4 mb-2 mt-1">
                        <div class="bg-gradient-to-r from-yellow-400 to-yellow-600 h-4 rounded-full transition-all duration-500 flex items-center justify-end pr-2" 
                             id="progressBar" style="width: 0%">
                            <i class="fas fa-star text-white text-xs opacity-90"></i>
                        </div>
                    </div>
                    <div class="text-gray-600 text-center font-bold" id="progressText" style="font-size: 0.9rem;">0 / 10 í¬ì¸íŠ¸</div>
                </div>
            </div>

            <!-- 3. ì˜¤ëŠ˜ì˜ í• ì¼ â†’ ì˜¤ëŠ˜ì˜ ë½‘ê¸° (í”Œë¦½ ì¹´ë“œ) -->
            <div class="grid-item daily-tasks">
                <!-- í”Œë¦½ ì¹´ë“œ ì»¨í…Œì´ë„ˆ -->
                <div class="daily-tasks-flip-card" id="dailyTasksFlipCard" onclick="console.log('ğŸš¨ CLICK EVENT í™•ì¸!'); toggleDailyTasksCard()">
                    <div class="daily-tasks-flip-inner">
                        
                        <!-- ì•ë©´: ì˜¤ëŠ˜ì˜ í• ì¼ -->
                        <div class="daily-tasks-front">
                            <div id="taskSection" class="flex flex-col h-full">
                                <h3 class="font-bold mb-1 text-center" style="font-size: 1.4rem;">ğŸ“‹ ì˜¤ëŠ˜ì˜ í• ì¼</h3>
                                
                                <div class="space-y-1 flex-1 flex flex-col justify-center">
                                    <!-- Stage 1 -->
                                    <div class="border border-blue-200 rounded-md p-1 bg-white shadow-sm hover:shadow-md transition-shadow" id="stage1Card">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-1">
                                                <div class="w-8 h-8 rounded-full flex items-center justify-center bg-blue-100" id="stage1Icon">
                                                    <span style="font-size: 1.2rem;">ğŸ™</span>
                                                </div>
                                                <div>
                                                    <h4 class="font-bold text-gray-800" style="font-size: 0.6rem;">1ë‹¨ê³„: ê¹€ë°¥ë§ê¸°</h4>
                                                    <p class="text-gray-600" style="font-size: 0.5rem;">ê¹€ë°¥ì„ ë§ì•„ë³´ì„¸ìš” (+1í¬ì¸íŠ¸)</p>
                                                </div>
                                            </div>
                                            <button onclick="completeStage(1); event.stopPropagation();" id="stage1Btn" class="px-2 py-1 rounded text-xs font-medium transition-colors" style="min-width: 3rem;">ì‹œì‘</button>
                                        </div>
                                    </div>

                                    <!-- Stage 2 -->
                                    <div class="border border-blue-200 rounded-md p-1 bg-white shadow-sm hover:shadow-md transition-shadow" id="stage2Card">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-1">
                                                <div class="w-8 h-8 rounded-full flex items-center justify-center bg-green-100" id="stage2Icon">
                                                    <span style="font-size: 1.2rem;">âœ¨</span>
                                                </div>
                                                <div>
                                                    <h4 class="font-bold text-gray-800" style="font-size: 0.6rem;">2ë‹¨ê³„: ê¹€ë°¥ì°ê¸°</h4>
                                                    <p class="text-gray-600" style="font-size: 0.5rem;">ê¹€ë°¥ì„ ì˜ˆì˜ê²Œ ì°ì–´ë³´ì„¸ìš” (+1í¬ì¸íŠ¸)</p>
                                                </div>
                                            </div>
                                            <button onclick="completeStage(2); event.stopPropagation();" id="stage2Btn" class="px-2 py-1 rounded text-xs font-medium transition-colors" style="min-width: 3rem;">ì ê¸ˆ</button>
                                        </div>
                                    </div>

                                    <!-- Stage 3 -->
                                    <div class="border border-blue-200 rounded-md p-1 bg-white shadow-sm hover:shadow-md transition-shadow" id="stage3Card">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-1">
                                                <div class="w-8 h-8 rounded-full flex items-center justify-center bg-purple-100" id="stage3Icon">
                                                    <span style="font-size: 1.2rem;">â•</span>
                                                </div>
                                                <div>
                                                    <h4 class="font-bold text-gray-800" style="font-size: 0.6rem;">3ë‹¨ê³„: ê¹€ë°¥ì¶”ê°€</h4>
                                                    <p class="text-gray-600" style="font-size: 0.5rem;">ë” ë§ì€ ê¹€ë°¥ì„ ë§Œë“¤ì–´ë³´ì„¸ìš” (+1í¬ì¸íŠ¸)</p>
                                                </div>
                                            </div>
                                            <button onclick="completeStage(3); event.stopPropagation();" id="stage3Btn" class="px-2 py-1 rounded text-xs font-medium transition-colors" style="min-width: 3rem;">ì ê¸ˆ</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- í”Œë¦½ íŒíŠ¸ (2ë‹¨ê³„ ì™„ë£Œì‹œì—ë§Œ í‘œì‹œ) -->
                                <div id="flipHint" class="hidden text-center mt-2">
                                    <p class="text-xs text-purple-600 animate-pulse">
                                        ğŸ í´ë¦­í•˜ì—¬ ì˜¤ëŠ˜ì˜ ë½‘ê¸° í•˜ê¸°!
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ë’·ë©´: ì˜¤ëŠ˜ì˜ ë½‘ê¸° -->
                        <div class="daily-tasks-back">
                            <div class="flex flex-col h-full justify-center items-center text-center p-4">
                                <div id="luckyDrawContent">
                                    <!-- ë½‘ê¸° ì‚¬ìš© ê°€ëŠ¥ ìƒíƒœ -->
                                    <div id="luckyDrawAvailable" class="hidden">
                                        <h3 class="text-2xl font-bold text-white mb-4">ğŸ ì˜¤ëŠ˜ì˜ ë½‘ê¸°</h3>
                                        <div class="mb-6">
                                            <div class="text-6xl mb-4">ğŸ°</div>
                                            <p class="text-white text-lg mb-2">2ë‹¨ê³„ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!</p>
                                            <p class="text-purple-200 text-sm mb-4">íŠ¹ë³„í•œ ì„ ë¬¼ì„ ë°›ì•„ë³´ì„¸ìš”</p>
                                        </div>
                                        <button onclick="performLuckyDraw(); event.stopPropagation();" 
                                                class="bg-white bg-opacity-20 backdrop-blur text-white py-3 px-6 rounded-lg hover:bg-opacity-30 transition text-lg font-bold border-2 border-white border-opacity-40 shadow-lg">
                                            ğŸ² ë½‘ê¸° í•˜ê¸°!
                                        </button>
                                    </div>
                                    
                                    <!-- ì¡°ê±´ ë¯¸ì¶©ì¡± ìƒíƒœ -->
                                    <div id="luckyDrawUnavailable">
                                        <h3 class="text-xl font-bold text-white mb-4">ğŸ”’ ì˜¤ëŠ˜ì˜ ë½‘ê¸°</h3>
                                        <div class="mb-6">
                                            <div class="text-4xl mb-4 opacity-50">ğŸ°</div>
                                            <p class="text-white text-base mb-2">2ë‹¨ê³„ë¥¼ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”!</p>
                                            <p class="text-purple-200 text-sm">ì™„ë£Œ í›„ íŠ¹ë³„í•œ ì„ ë¬¼ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”</p>
                                        </div>
                                    </div>
                                    
                                    <!-- ì´ë¯¸ ë½‘ê¸° ì™„ë£Œ ìƒíƒœ -->
                                    <div id="luckyDrawCompleted" class="hidden">
                                        <h3 class="text-xl font-bold text-white mb-4">âœ… ë½‘ê¸° ì™„ë£Œ</h3>
                                        <div class="mb-6">
                                            <div class="text-4xl mb-4">ğŸ</div>
                                            <p class="text-white text-base mb-2">ì˜¤ëŠ˜ ì´ë¯¸ ë½‘ê¸°ë¥¼ í–ˆìŠµë‹ˆë‹¤</p>
                                            <p class="text-purple-200 text-sm">ë‚´ì¼ ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”!</p>
                                        </div>
                                        <div id="todayDrawResult" class="bg-white bg-opacity-20 rounded-lg p-3 mt-4">
                                            <p class="text-white font-bold">ì˜¤ëŠ˜ì˜ ê²°ê³¼:</p>
                                            <p class="text-yellow-200 text-lg" id="todayDrawMessage">-</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>

            <!-- 4. ì—­í• ë°°ì • -->
            <div class="grid-item role-assignment">
                <h3 class="font-bold mb-2 text-center" style="font-size: 1.4rem;">ğŸ­ ì—­í•  ë°°ì •</h3>
                
                <!-- No Role Message -->
                <div id="noRoleMessage" class="hidden text-center flex-1 flex flex-col justify-center">
                    <i class="fas fa-hourglass-half text-3xl text-yellow-500 mb-3"></i>
                    <p class="text-gray-600 mb-2 font-semibold" style="font-size: 1rem;">ì„ ìƒë‹˜ì´ ì—­í• ì„ ë°°ì •í•  ë•Œë§Œ<br>í‘œì‹œë©ë‹ˆë‹¤</p>
                    <button onclick="checkRoleAgain()" class="bg-yellow-500 text-white px-3 py-2 rounded-lg font-bold hover:bg-yellow-600 transition-colors" style="font-size: 0.8rem;">
                        <i class="fas fa-sync-alt mr-2 text-sm"></i>ë‹¤ì‹œ í™•ì¸
                    </button>
                </div>

                <!-- Role Display -->
                <div id="roleDisplay" class="hidden flex-1 flex flex-col min-h-0">
                    <div id="roleCard" class="flex-1 flex flex-col h-full max-h-full">
                        <!-- ê°œì„ ëœ í”Œë¦½ ì¹´ë“œ êµ¬ì¡° (3D íš¨ê³¼) -->
                        <div class="flip-card" id="flipCard" onclick="flipCard()">
                            <div class="flip-card-inner">
                                <!-- ì¹´ë“œ ì•ë©´ - ì™„ì „ ìƒˆë¡œìš´ êµ¬ì¡° -->
                                <div class="card-face card-front">
                                    <!-- ë‹¨ì¼ ì—­í•  í‘œì‹œ ì˜ì—­ -->
                                    <div id="roleContent" class="h-full flex flex-col justify-center items-center text-center">
                                        <!-- ì—­í•  ì œëª© (í•­ìƒ í‘œì‹œ) -->
                                        <h1 id="mainRoleTitle" class="text-2xl font-bold text-white mb-1">ì—­í•  ì œëª©</h1>
                                        
                                        <!-- ì´ë¯¸ì§€ ì—­í• ì¼ ë•Œë§Œ í‘œì‹œ -->
                                        <div id="roleImageContainer" class="hidden flex-1 w-full flex items-center justify-center">
                                            <img id="mainRoleImage" 
                                                 src="" 
                                                 alt="ì—­í•  ì´ë¯¸ì§€" 
                                                 class="max-w-[75%] max-h-[75%] object-contain rounded-lg">
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ì¹´ë“œ ë’·ë©´ -->
                                <div class="card-face card-back">
                                    <!-- ì»¨í…ì¸  ì˜ì—­ (ì „ì²´ ê³µê°„ ì‚¬ìš©) -->
                                    <div class="card-back-content">
                                        <div id="detailMissions">
                                            <!-- í™œë™ë°©ë²• ì•ˆë‚´ê°€ JavaScriptë¡œ ë™ì  ì„¤ì •ë©ë‹ˆë‹¤ -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5. í•™ìŠµì•ˆë‚´ (í”Œë¦½ì¹´ë“œ) -->
            <div class="grid-item notice-board learning-guide-flip-card" id="learningGuideFlipCard" onclick="toggleLearningGuideCard()">
                <div class="learning-guide-flip-inner">
                    <!-- ì•ë©´: ê¸°ë³¸ í•™ìŠµì•ˆë‚´ ìƒíƒœ -->
                    <div class="learning-guide-front">
                        <h3 class="font-bold mb-2 text-center text-gray-700" style="font-size: 1.4rem;">ğŸ“¢ í•™ìŠµì•ˆë‚´</h3>
                        <div class="flex-1 flex flex-col justify-center items-center">
                            <div id="fixedNoticeBoard" class="space-y-4 notice-text w-full">
                                <!-- ê³ ì •ê³µì§€ì‚¬í•­ì´ ì—†ì„ ë•Œ í‘œì‹œ -->
                                <div class="text-center text-gray-500 py-4">
                                    <i class="fas fa-book-open text-3xl mb-2 text-blue-400"></i>
                                    <p style="font-size: 0.8rem;">í´ë¦­í•˜ì—¬ ìë£Œë§í¬ í™•ì¸</p>
                                    <div class="mt-2">
                                        <i class="fas fa-mouse-pointer text-blue-500 animate-bounce"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ë’·ë©´: ìƒì„¸ í•™ìŠµì•ˆë‚´ ë‚´ìš© -->
                    <div class="learning-guide-back">
                        <div class="h-full flex flex-col">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-bold text-white" style="font-size: 1.4rem;">ğŸ”— ìë£Œë§í¬</h3>
                                <button onclick="event.stopPropagation(); toggleLearningGuideCard()" class="text-white hover:text-gray-200 transition-colors opacity-80 hover:opacity-100">
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                            
                            <div class="flex-1 overflow-y-auto">
                                <div id="learningGuideContent" class="text-white space-y-3">
                                    <!-- í•™ìŠµì•ˆë‚´ ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                                    <div class="text-center py-8">
                                        <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                        <p>í•™ìŠµì•ˆë‚´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                                    </div>
                                </div>
                                
                                <!-- ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ -->
                                <div class="mt-4 text-center">
                                    <button onclick="event.stopPropagation(); loadLearningGuideContent()" 
                                            class="text-white hover:text-white text-sm bg-white bg-opacity-15 hover:bg-opacity-25 px-3 py-1 rounded transition-all">
                                        <i class="fas fa-sync-alt mr-1"></i>ìƒˆë¡œê³ ì¹¨
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6. ì„ ìƒë‹˜ë§ì”€ (ê°œì¸ ë©”ì‹œì§€í•¨) - í”Œë¦½ ì¹´ë“œ êµ¬ì¡° -->
            <div class="grid-item teacher-message">
                <h3 class="font-bold mb-2 text-center text-gray-700" style="font-size: 1.4rem;">ğŸ“® ì„ ìƒë‹˜ ìª½ì§€í•¨</h3>
                
                <!-- ë©”ì‹œì§€ í”Œë¦½ ì¹´ë“œ -->
                <div class="message-flip-card" id="messageFlipCard">
                    <div class="message-flip-inner">
                        <!-- ì¹´ë“œ ì•ë©´: ë©”ì‹œì§€ ëª©ë¡ -->
                        <div class="message-card-front">
                            <div class="flex-1 overflow-y-auto" style="max-height: 100%; height: 100%;">
                                <div id="personalMessagesContainer" class="p-0.5" style="height: 100%;">
                                    <!-- Messages will be loaded here -->
                                    <div class="text-center text-gray-400 py-6 flex flex-col items-center justify-center" style="height: 100%;">
                                        <i class="fas fa-envelope text-4xl mb-3 text-gray-300"></i>
                                        <p style="font-size: 0.95rem; font-weight: 500;">ë°›ì€ ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ì¹´ë“œ ë’·ë©´: ë‹µì¥ ì‘ì„± -->
                        <div class="message-card-back cursor-pointer" onclick="flipMessageCard()">
                            <div class="h-full flex flex-col justify-between" onclick="event.stopPropagation()">
                                <!-- ë‹µì¥ ë‚´ìš© ì…ë ¥ -->
                                <textarea id="replyContent" 
                                          rows="4" 
                                          class="w-full px-3 py-2.5 bg-white bg-opacity-95 border border-white border-opacity-60 rounded-lg focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-70 resize-none" 
                                          style="font-size: 0.9rem; line-height: 1.3; min-height: 100px; max-height: 140px;"></textarea>
                                
                                <!-- ë²„íŠ¼ ì˜ì—­ -->
                                <div class="flex justify-center mt-2">
                                    <button onclick="sendReply()" class="bg-white bg-opacity-40 backdrop-blur text-white py-1 px-3 rounded-lg hover:bg-opacity-50 transition text-xs font-bold border border-white border-opacity-40 shadow-md">
                                        <i class="fas fa-paper-plane mr-1 text-xs"></i>ë‹µì¥ ë³´ë‚´ê¸°
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Hidden Reply Section for compatibility (ê¸°ì¡´ ì½”ë“œ í˜¸í™˜ì„± ìœ ì§€) -->
                <div id="replySection" class="hidden"></div>
            </div>

        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen">
            <div class="bg-white rounded-lg p-8 text-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"></div>
                <p class="text-xl text-gray-700">ì—­í• ì„ í™•ì¸í•˜ëŠ” ì¤‘...</p>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl max-w-md w-full p-6">
                <div class="text-center">
                    <i class="fas fa-exclamation-circle text-5xl text-red-500 mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">í™•ì¸ ì‹¤íŒ¨</h3>
                    <p class="text-xl text-gray-600 mb-6" id="errorMessage">í•™ë²ˆê³¼ ì´ë¦„ì„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                    <button onclick="closeError()" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition">
                        í™•ì¸
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ê¹€ë°¥ì¶”ê°€ ê²½ê³  ëª¨ë‹¬ -->
    <div id="kimbapWarningModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl max-w-md w-full p-6">
                <div class="text-center">
                    <i class="fas fa-exclamation-triangle text-5xl text-yellow-500 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ê¹€ë°¥ì¶”ê°€ í™•ì¸</h3>
                    <p class="text-gray-600 mb-6 leading-relaxed">
                        ê¹€ë°¥ ì¶”ê°€ì˜ ê²½ìš° ì„ ìƒë‹˜ì´ ë¯¸ë¦¬ í—ˆë½í•œ ê²½ìš°ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>
                        í—ˆë½ì—†ì´ ì¶”ê°€í•œ ê²½ìš° ì„ ìƒë‹˜ì´ ë¶€ë¥´ê±°ë‚˜ ì·¨ì†Œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <div class="flex space-x-3">
                        <button onclick="cancelKimbapAdd()" class="flex-1 bg-gray-500 text-white py-3 px-4 rounded-lg hover:bg-gray-600 transition">
                            ì·¨ì†Œ
                        </button>
                        <button onclick="confirmKimbapAdd()" class="flex-1 bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 transition">
                            í™•ì¸
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Supabase ì´ˆê¸°í™” ë‹¨ìˆœí™” -->
    <script>
        console.log('[Supabase Inline] ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘');
        
        let globalSupabaseClient = null;
        
        // DOM ë¡œë“œ í›„ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('[Supabase Inline] DOM ë¡œë“œ ì™„ë£Œ, ì´ˆê¸°í™” ì‹œë„');
            
            function initializeSupabaseInline() {
                if (typeof window.supabase !== 'undefined' && typeof SUPABASE_URL !== 'undefined') {
                    try {
                        globalSupabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                        console.log('[Supabase Inline] ì´ˆê¸°í™” ì„±ê³µ');
                        
                        // ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ë°œì†¡
                        window.dispatchEvent(new CustomEvent('supabaseInitialized', { 
                            detail: { client: globalSupabaseClient } 
                        }));
                        
                        return true;
                    } catch (error) {
                        console.error('[Supabase Inline] ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                        return false;
                    }
                } else {
                    console.log('[Supabase Inline] window.supabase ì•„ì§ ì¤€ë¹„ ì•ˆë¨');
                    return false;
                }
            }
            
            // ì¦ì‹œ ì´ˆê¸°í™” ì‹œë„
            if (!initializeSupabaseInline()) {
                // 1ì´ˆ í›„ ë‹¤ì‹œ ì‹œë„
                setTimeout(() => {
                    if (!initializeSupabaseInline()) {
                        console.warn('[Supabase Inline] ì´ˆê¸°í™” 2ë²ˆ ì‹¤íŒ¨ - ë¡œì»¬ ëª¨ë“œë¡œ ì§„í–‰');
                    }
                    console.log('[Supabase Inline] ì´ˆê¸°í™” ì™„ë£Œ');
                }, 1000);
            } else {
                console.log('[Supabase Inline] ì´ˆê¸°í™” ì™„ë£¼');
            }
        });
    </script>
    
    <!-- ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script src="static/supabase-config.js"></script>
    <script src="static/api-wrapper.js"></script>
    <script src="static/supabase-api.js"></script>
    <script src="static/main.js"></script>
    <script src="static/student.js"></script>
    <script src="static/student-stage-settings.js"></script>
    <!-- Simple Point System (2025-01-19) - ëª¨ë“  í¬ì¸íŠ¸ ê¸°ëŠ¥ ëŒ€ì²´ ë° ë¬¸ì œ ì°¨ë‹¨ -->
    <script>
        console.log('ğŸš€ [HTML] JavaScript íŒŒì¼ë“¤ ë¡œë“œ ì™„ë£Œ!');
        console.log('ğŸ” [HTML] toggleDailyTasksCard í•¨ìˆ˜ í™•ì¸:', typeof window.toggleDailyTasksCard);
    </script>
    <script>
        // student.js ë¡œë“œ ì§í›„ ì¦‰ì‹œ ë¬¸ì œ í•¨ìˆ˜ ì°¨ë‹¨
        window.checkForNewTeacherPoints = function() { return; };
        window.showTeacherPointNotification = function() { return; };
        window.checkForTeacherPoints = function() { return; };
        window.refreshStudentPoints = function() { return; };
        if (window.teacherPointCheckInterval) {
            clearInterval(window.teacherPointCheckInterval);
        }
        console.log('[Emergency] ë¬¸ì œ í•¨ìˆ˜ ì¦‰ì‹œ ì°¨ë‹¨');
    </script>

    <!-- í¬ì¸íŠ¸ ìƒˆë¡œê³ ì¹¨ ìƒíƒœ í‘œì‹œê¸° (ë°±ê·¸ë¼ìš´ë“œ ëª¨ë“œ) -->
    <div id="pointRefreshIndicator" class="fixed bottom-4 right-4 z-40 bg-white border border-gray-300 rounded-lg shadow-lg p-3 text-sm" style="display: none; opacity: 0; pointer-events: none;">
        <div class="flex items-center space-x-2">
            <div id="refreshIcon" class="w-4 h-4">
                <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"></div>
            </div>
            <div>
                <div id="refreshStatus" class="font-medium text-gray-700">í¬ì¸íŠ¸ ìƒˆë¡œê³ ì¹¨</div>
                <div id="refreshTime" class="text-xs text-gray-500">ì¤€ë¹„ ì¤‘...</div>
            </div>
        </div>
    </div>

</body>
</html>